GPU: NVIDIA GeForce RTX 3060 Ti
사용 가능한 VRAM: 8.00 GB
토크나이저 로딩...
모델 로딩 (4-bit 양자화)...
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:07<00:15,  7.85s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:15<00:07,  7.79s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:22<00:00,  7.43s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:22<00:00,  7.54s/it]
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
LoRA 어댑터 추가...
trainable params: 167,772,160 || all params: 7,409,520,640 || trainable%: 2.2643
데이터셋 로딩...
학습 시작...
체크포인트에서 재개: ../../ai-service/models/lora_gen_4bit/checkpoint-400
  0%|          | 0/500 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
 80%|████████  | 401/500 [05:10<01:16,  1.29it/s] 80%|████████  | 402/500 [10:01<02:56,  1.80s/it] 81%|████████  | 403/500 [14:37<05:09,  3.19s/it] 81%|████████  | 404/500 [19:27<08:22,  5.24s/it] 81%|████████  | 405/500 [24:19<12:53,  8.15s/it] 81%|████████  | 406/500 [29:10<19:04, 12.18s/it] 81%|████████▏ | 407/500 [34:15<27:55, 18.02s/it] 82%|████████▏ | 408/500 [38:49<38:30, 25.11s/it] 82%|████████▏ | 409/500 [43:25<52:34, 34.67s/it] 82%|████████▏ | 410/500 [48:02<1:10:45, 47.17s/it] 82%|████████▏ | 411/500 [52:37<1:33:10, 62.81s/it] 82%|████████▏ | 412/500 [57:13<1:59:59, 81.81s/it] 83%|████████▎ | 413/500 [1:02:04<2:33:01, 105.53s/it] 83%|████████▎ | 414/500 [1:06:41<3:05:21, 129.32s/it] 83%|████████▎ | 415/500 [1:11:29<3:40:38, 155.75s/it] 83%|████████▎ | 416/500 [1:16:06<4:10:27, 178.89s/it] 83%|████████▎ | 417/500 [1:20:42<4:36:26, 199.83s/it] 84%|████████▎ | 418/500 [1:25:19<4:57:38, 217.78s/it] 84%|████████▍ | 419/500 [1:30:07<5:17:58, 235.54s/it] 84%|████████▍ | 420/500 [1:35:02<5:35:02, 251.28s/it] 84%|████████▍ | 421/500 [1:39:46<5:42:24, 260.06s/it] 84%|████████▍ | 422/500 [1:44:22<5:43:57, 264.58s/it] 85%|████████▍ | 423/500 [1:48:58<5:43:50, 267.93s/it] 85%|████████▍ | 424/500 [1:54:01<5:52:06, 277.99s/it] 85%|████████▌ | 425/500 [1:58:48<5:50:57, 280.76s/it]                                                       85%|████████▌ | 425/500 [1:58:48<5:50:57, 280.76s/it] 85%|████████▌ | 426/500 [2:03:30<5:46:47, 281.18s/it] 85%|████████▌ | 427/500 [2:08:19<5:44:44, 283.35s/it] 86%|████████▌ | 428/500 [2:12:54<5:37:17, 281.08s/it] 86%|████████▌ | 429/500 [2:17:36<5:32:52, 281.30s/it] 86%|████████▌ | 430/500 [2:22:12<5:26:15, 279.64s/it] 86%|████████▌ | 431/500 [2:26:48<5:20:13, 278.46s/it] 86%|████████▋ | 432/500 [2:31:21<5:13:44, 276.83s/it] 87%|████████▋ | 433/500 [2:35:56<5:08:46, 276.52s/it] 87%|████████▋ | 434/500 [2:40:32<5:03:56, 276.31s/it] 87%|████████▋ | 435/500 [2:45:08<4:59:13, 276.20s/it] 87%|████████▋ | 436/500 [2:49:44<4:54:37, 276.21s/it] 87%|████████▋ | 437/500 [2:54:37<4:55:05, 281.04s/it] 88%|████████▊ | 438/500 [2:59:25<4:52:32, 283.10s/it] 88%|████████▊ | 439/500 [3:04:01<4:45:39, 280.98s/it] 88%|████████▊ | 440/500 [3:08:33<4:38:30, 278.52s/it] 88%|████████▊ | 441/500 [3:13:25<4:37:38, 282.35s/it] 88%|████████▊ | 442/500 [3:18:08<4:33:07, 282.55s/it] 89%|████████▊ | 443/500 [3:22:40<4:25:32, 279.52s/it] 89%|████████▉ | 444/500 [3:27:16<4:19:52, 278.45s/it] 89%|████████▉ | 445/500 [3:32:05<4:17:58, 281.43s/it] 89%|████████▉ | 446/500 [3:36:53<4:15:05, 283.43s/it] 89%|████████▉ | 447/500 [3:41:48<4:13:31, 287.02s/it] 90%|████████▉ | 448/500 [3:46:24<4:05:46, 283.59s/it] 90%|████████▉ | 449/500 [3:50:56<3:58:14, 280.28s/it] 90%|█████████ | 450/500 [3:55:48<3:56:24, 283.69s/it]                                                       90%|█████████ | 450/500 [3:55:48<3:56:24, 283.69s/it] 90%|█████████ | 451/500 [4:00:36<3:52:42, 284.95s/it] 90%|█████████ | 452/500 [4:05:09<3:45:02, 281.31s/it] 91%|█████████ | 453/500 [4:09:45<3:39:10, 279.80s/it] 91%|█████████ | 454/500 [4:14:21<3:33:45, 278.81s/it] 91%|█████████ | 455/500 [4:18:54<3:27:47, 277.07s/it] 91%|█████████ | 456/500 [4:23:32<3:23:24, 277.38s/it] 91%|█████████▏| 457/500 [4:28:33<3:23:46, 284.34s/it] 92%|█████████▏| 458/500 [4:33:09<3:17:17, 281.85s/it] 92%|█████████▏| 459/500 [4:38:11<3:16:43, 287.89s/it] 92%|█████████▏| 460/500 [4:43:00<3:12:04, 288.12s/it] 92%|█████████▏| 461/500 [4:47:48<3:07:20, 288.22s/it] 92%|█████████▏| 462/500 [4:52:25<3:00:20, 284.76s/it] 93%|█████████▎| 463/500 [4:57:01<2:54:02, 282.23s/it] 93%|█████████▎| 464/500 [5:01:50<2:50:26, 284.07s/it] 93%|█████████▎| 465/500 [5:06:42<2:47:12, 286.64s/it] 93%|█████████▎| 466/500 [5:11:50<2:45:57, 292.88s/it] 93%|█████████▎| 467/500 [5:16:23<2:37:50, 286.99s/it] 94%|█████████▎| 468/500 [5:21:07<2:32:33, 286.04s/it] 94%|█████████▍| 469/500 [5:25:57<2:28:24, 287.24s/it] 94%|█████████▍| 470/500 [5:30:57<2:25:36, 291.21s/it] 94%|█████████▍| 471/500 [5:35:41<2:19:44, 289.12s/it] 94%|█████████▍| 472/500 [5:40:18<2:13:09, 285.34s/it] 95%|█████████▍| 473/500 [5:45:07<2:08:54, 286.47s/it] 95%|█████████▍| 474/500 [5:49:44<2:02:53, 283.60s/it] 95%|█████████▌| 475/500 [5:54:24<1:57:39, 282.39s/it]                                                       95%|█████████▌| 475/500 [5:54:24<1:57:39, 282.39s/it] 95%|█████████▌| 476/500 [5:59:07<1:53:05, 282.71s/it] 95%|█████████▌| 477/500 [6:04:07<1:50:23, 288.00s/it] 96%|█████████▌| 478/500 [6:09:16<1:47:52, 294.18s/it] 96%|█████████▌| 479/500 [6:14:16<1:43:37, 296.07s/it] 96%|█████████▌| 480/500 [6:19:12<1:38:37, 295.85s/it] 96%|█████████▌| 481/500 [6:23:55<1:32:31, 292.20s/it] 96%|█████████▋| 482/500 [6:28:52<1:28:04, 293.61s/it] 97%|█████████▋| 483/500 [6:33:48<1:23:22, 294.26s/it] 97%|█████████▋| 484/500 [6:38:46<1:18:47, 295.48s/it] 97%|█████████▋| 485/500 [6:43:41<1:13:48, 295.23s/it] 97%|█████████▋| 486/500 [6:48:24<1:08:03, 291.65s/it] 97%|█████████▋| 487/500 [6:53:15<1:03:06, 291.31s/it] 98%|█████████▊| 488/500 [6:58:10<58:29, 292.49s/it]   98%|█████████▊| 489/500 [7:03:02<53:36, 292.37s/it] 98%|█████████▊| 490/500 [7:08:13<49:39, 297.98s/it] 98%|█████████▊| 491/500 [7:13:12<44:42, 298.06s/it] 98%|█████████▊| 492/500 [7:18:21<40:12, 301.50s/it] 99%|█████████▊| 493/500 [7:23:28<35:22, 303.16s/it] 99%|█████████▉| 494/500 [7:28:38<30:30, 305.10s/it] 99%|█████████▉| 495/500 [7:33:21<24:52, 298.43s/it] 99%|█████████▉| 496/500 [7:38:16<19:50, 297.60s/it] 99%|█████████▉| 497/500 [7:43:10<14:49, 296.49s/it]100%|█████████▉| 498/500 [7:48:03<09:50, 295.47s/it]100%|█████████▉| 499/500 [7:52:51<04:52, 292.99s/it]100%|██████████| 500/500 [7:57:59<00:00, 297.77s/it]                                                    100%|██████████| 500/500 [7:57:59<00:00, 297.77s/it]                                                    100%|██████████| 500/500 [7:58:11<00:00, 297.77s/it]100%|██████████| 500/500 [7:58:11<00:00, 57.38s/it] 
{'loss': 0.7593, 'grad_norm': 0.27342140674591064, 'learning_rate': 5.066666666666666e-05, 'epoch': 0.33}
{'loss': 0.7154, 'grad_norm': 0.2905951738357544, 'learning_rate': 3.399999999999999e-05, 'epoch': 0.35}
{'loss': 0.6944, 'grad_norm': 0.29791414737701416, 'learning_rate': 1.7333333333333332e-05, 'epoch': 0.37}
{'loss': 0.7095, 'grad_norm': 0.29686668515205383, 'learning_rate': 6.666666666666666e-07, 'epoch': 0.39}
{'train_runtime': 28691.6369, 'train_samples_per_second': 0.139, 'train_steps_per_second': 0.017, 'train_loss': 0.14392621612548828, 'epoch': 0.39}
모델 저장: ../../ai-service/models/lora_gen_4bit
학습 완료!
최대 VRAM 사용량: 9.15 GB
